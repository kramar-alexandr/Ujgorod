external procedure ExtractObj(string,var Integer,var string);SetLangMode(LangRussian,"UKR",0);globalprocedure RetIVCoincidenceRn(record RcVc RepSpec)BEGIN  record IVVc IVr,retIVr;  row IVVc IVrw,retIVrw;  date sd,ed;  Integer pos,rwcnt,i;  //sd = RepSpec.sStartDate;  //ed = RepSpec.sEndDate;    StartReportJob("Пошук невідповідностей в акт/н. на повернення");    Header(3,USetStr(28206) & " " & sd & ":" & ed,0);  EndHeader;    StartFormat(15);    pos = 0;    OutString(pos,0,"Акт/н.повер.",false);    pos = pos + 50;    OutString(pos,0,"Рядок",false);    pos = pos + 30;    OutString(pos,0,"Товар",false);    pos = pos + 70;    OutString(pos,0,"Серійний номер",false);    pos = pos + 120;    OutString(pos,0,"Акт/н.джерело",false);    pos = pos + 50;    OutString(pos,0,"Товар",false);    pos = pos + 70;    OutString(pos,0,"Серійний номер",false);  EndFormat;  Black_Divider(0,1);	  IVr.SerNr = -1;  while (LoopMain(IVr,1,true)) begin  	rwcnt = MatRowCnt(IVr);  	for (i=0;i<rwcnt;i=i+1) begin  	  MatRowGet(IVr,i,IVrw);  	  if (IVrw.Quant<0 and IVrw.RetIVNum>-1) then begin        retIVr.SerNr = IVrw.RetIVNum;        ReadFirstMain(retIVr,1,true);        MatRowGet(retIVr,IVrw.RetIVRow,retIVrw);        if (IVrw.ArtCode!=retIVrw.ArtCode or IVrw.SerialNr!=retIVrw.SerialNr) then begin          StartFormat(15);            pos = 0;            OutString(pos,"DblIVVc",IVr.SerNr,false);            pos = pos + 50;            OutString(pos,0,i+1,false);            pos = pos + 30;            OutString(pos,0,IVrw.ArtCode,false);            pos = pos + 70;            OutString(pos,0,IVrw.SerialNr,false);            pos = pos + 120;            OutString(pos,"DblIVVc",retIVr.SerNr,false);            pos = pos + 50;            OutString(pos,0,retIVrw.ArtCode,false);            pos = pos + 70;            OutString(pos,0,retIVrw.SerialNr,false);          EndFormat;        end;      end;  	end;  end;   endjob;  LRetIVCoincidenceRn:;     RETURN;END;